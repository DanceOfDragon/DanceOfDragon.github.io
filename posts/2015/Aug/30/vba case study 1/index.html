<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="JIN Lin">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title><span class="caps">VBA</span>-case study&nbsp;1 | JL-Blog | No Bullshit</title>

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" title="JL-Blog | No Bullshit blog atom feed" href="/feeds/all.atom.xml" />
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="/theme/css/icons.css"/>
        <style>.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #60a0b0; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #007020; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #007020 } /* Comment.Preproc */
.highlight .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.highlight .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #808080 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #007020 } /* Keyword.Pseudo */
.highlight .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #902000 } /* Keyword.Type */
.highlight .m { color: #40a070 } /* Literal.Number */
.highlight .s { color: #4070a0 } /* Literal.String */
.highlight .na { color: #4070a0 } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.highlight .no { color: #60add5 } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #007020 } /* Name.Exception */
.highlight .nf { color: #06287e } /* Name.Function */
.highlight .nl { color: #002070; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #062873; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #bb60d5 } /* Name.Variable */
.highlight .ow { color: #007020; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #40a070 } /* Literal.Number.Float */
.highlight .mh { color: #40a070 } /* Literal.Number.Hex */
.highlight .mi { color: #40a070 } /* Literal.Number.Integer */
.highlight .mo { color: #40a070 } /* Literal.Number.Oct */
.highlight .sb { color: #4070a0 } /* Literal.String.Backtick */
.highlight .sc { color: #4070a0 } /* Literal.String.Char */
.highlight .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4070a0 } /* Literal.String.Double */
.highlight .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #4070a0 } /* Literal.String.Heredoc */
.highlight .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.highlight .sx { color: #c65d09 } /* Literal.String.Other */
.highlight .sr { color: #235388 } /* Literal.String.Regex */
.highlight .s1 { color: #4070a0 } /* Literal.String.Single */
.highlight .ss { color: #517918 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #bb60d5 } /* Name.Variable.Class */
.highlight .vg { color: #bb60d5 } /* Name.Variable.Global */
.highlight .vi { color: #bb60d5 } /* Name.Variable.Instance */
.highlight .il { color: #40a070 } /* Literal.Number.Integer.Long */</style>
        <style>body {
  margin: 0;
  padding: 0;
  font: 15px 'Source Sans Pro', sans-serif;
  line-height: 1.6em;
  color: #222;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}
a {
  color: #007EE5;
  text-decoration: none;
}
a:hover {
  color: #007EE5;
  text-decoration: none;
}
header.main-header {
  background: none repeat scroll 0% 0% #205F29;
  margin-bottom: 0px;
}
header.main-header a {
  color: #fff;
}
header.main-header .container {
  max-width: 1000px;
}
header.main-header .container nav a:hover {
  background-color: #5C881C;
}
article {
  margin: 0;
}
article header.about {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
article header {
  margin-bottom: 20px;
  padding-bottom: 20px;
}
article header h1 {
  margin-bottom: 2px;
  font-weight: 700;
  color: #000;
}
article header time {
  color: #9E9E9E;
  font-size: 0.85em;
  float: right;
}
article header time.left {
  color: #9E9E9E;
  font-size: 0.85em;
  float: left;
}
article div.social-links ul {
  padding: 0px;
}
article div.social-links li {
  display: inline;
  font-size: 20px;
}
article div.social-links li a {
  color: #000;
  padding: 10px;
}
article div.social-links li a:hover {
  color: #666;
  text-decoration: none;
}
article p {
  font-size: 16px;
  margin-bottom: 20px;
  line-height: 1.6em;
}
article p.note {
  background: #f5f5f5;
  border: 1px solid #ddd;
  padding: 0.533em 0.733em;
}
article p.update {
  background-color: #FEEFB3;
  border: 1px solid #e6e68a;
  padding: 0.533em 0.733em;
}
article p.alert {
  background-color: #ffe2e2;
  border: 1px solid #ffb2b2;
  padding: 0.533em 0.733em;
}
article ul,
article ol {
  margin-top: 0px;
  margin-bottom: 25px;
}
article li {
  font-size: 16px;
  line-height: 1.6em;
}
article a:hover {
  text-decoration: underline;
}
article blockquote {
  border-left: 2px solid #c7c7cc;
  color: #666;
  margin: 30px 0;
  padding: 0 0 0 25px;
}
article img {
  max-width: 100%;
}
article code {
  color: #333;
  background-color: #EEE;
  border-radius: 0;
  font-size: 13px;
}
article .meta {
  font-size: 11px;
}
article .meta a:hover {
  text-decoration: none;
}
article .meta div {
  margin-bottom: 20px;
  display: block;
}
article .meta a.tag {
  margin: 0 10px 10px 0;
  padding: 1px 12px;
  display: inline-block;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.8);
  background: rgba(0, 0, 0, 0.05);
}
article .meta a.tag:hover {
  background: rgba(0, 0, 0, 0.15);
}
article .meta a.read_more,
article .meta a.comments_btn {
  font-size: 14px;
  font-weight: 800;
  padding: 10px 20px;
  color: #205F29;
  background: #FFF;
  border: 1px solid #205F29;
}
article .meta a.read_more:hover,
article .meta a.comments_btn:hover {
  color: #FFF;
  background: #5C881C;
}
.index {
  max-width: 700px;
}
.index article header h2 {
  font-size: 36px;
  margin-bottom: 2px;
  font-weight: 700;
}
.index article header h2 a {
  color: #000;
}
.index article header h2 a:hover {
  color: #007EE5;
  text-decoration: none;
}
.index .separator {
  padding: 40px 0 0 0;
  margin: 0 0 40px 0;
  height: 10px;
  border-bottom: solid 1px #CCC;
}
.index .pagination {
  display: block;
  margin-bottom: 100px;
}
.index .pagination .left {
  text-align: right;
}
.index .pagination .right {
  text-align: left;
}
.index .pagination a {
  display: inline-block;
  border: 2px solid #5C881C;
  margin: 0 5px;
  padding: 8px 20px;
  font-weight: bold;
  color: #5C881C;
}
.index .pagination a:hover {
  color: #FFF;
  background: #5C881C;
}
.post {
  max-width: 700px;
}
.post h2:before {
  content: "# ";
  font-weight: bold;
  color: #DDD;
}
.post h3:before {
  content: "## ";
  font-weight: bold;
  color: #DDD;
}
.post h4:before {
  content: "### ";
  font-weight: bold;
  color: #DDD;
}
.post article .meta {
  margin: 50px 0 100px;
}
.list {
  max-width: 700px;
}
.list ul.double-list {
  margin: 0 auto 60px;
  padding: 0;
  list-style-type: none;
}
.list ul.double-list li {
  padding: 5px 0;
}
.list ul.double-list li h2 {
  font-size: 1em;
  display: inline;
  font-weight: normal;
}
.list ul.double-list li span {
  font-family: sans-serif;
  text-transform: uppercase;
  text-align: right;
  float: right;
  padding-top: 3px;
  font-size: 12px;
  color: #999;
}
.full-width-content {
  padding-top: 10px;
  padding-left: 0px;
  padding-right: 0px;
  margin-left: -20px;
  margin-right: -20px;
}
.col-xs-1,
.col-sm-1,
.col-md-1,
.col-lg-1,
.col-xs-2,
.col-sm-2,
.col-md-2,
.col-lg-2,
.col-xs-3,
.col-sm-3,
.col-md-3,
.col-lg-3,
.col-xs-4,
.col-sm-4,
.col-md-4,
.col-lg-4,
.col-xs-5,
.col-sm-5,
.col-md-5,
.col-lg-5,
.col-xs-6,
.col-sm-6,
.col-md-6,
.col-lg-6,
.col-xs-7,
.col-sm-7,
.col-md-7,
.col-lg-7,
.col-xs-8,
.col-sm-8,
.col-md-8,
.col-lg-8,
.col-xs-9,
.col-sm-9,
.col-md-9,
.col-lg-9,
.col-xs-10,
.col-sm-10,
.col-md-10,
.col-lg-10,
.col-xs-11,
.col-sm-11,
.col-md-11,
.col-lg-11,
.col-xs-12,
.col-sm-12,
.col-md-12,
.col-lg-12 {
  padding-right: 0px;
  padding-left: 0px;
}</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
        <script type="text/javascript">
        init_mathjax = function() {
            if (window.MathJax) {
                // MathJax loaded
                MathJax.Hub.Config({
                    tex2jax: {
                        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
                    },
                    displayAlign: 'left', // Change this to 'center' to center equations.
                    "HTML-CSS": {
                        styles: {'.MathJax_Display': {"margin": 0}}
                    }
                });
                MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
            }
        }
        init_mathjax();
        </script>

    </head>

    <body>
        <header class="navbar navbar-inverse bs-docs-nav">
            <div class="container-fluid">
                <div class="navbar-header">
		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#theNavbar">
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span> 
		  </button>
                  <a class="navbar-brand" href="/" title="Home" class="title">JL-Blog | No Bullshit</a>
                </div>
                <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation" id="theNavbar">
		    <ul class="nav navbar-nav navbar-right">
                            <li><a href="/pages/about.html" title="About">About</a></li>
                            <li><a href="/archives.html" title="Archive">Archive</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div id="wrap">
<div class="container post">
    <article>
        <header>
            <h1><span class="caps">VBA</span>-case study&nbsp;1</h1>
            <time datetime="article.date.isoformat()" pubdate>Sun 30 August 2015</time>
        </header>

        <div class="article_content">
            <p>This is the case study I was given at an interview with <a href="http://www.mars.com/global/index.aspx">Mars Singapore</a>. Only in real fight does the truth be revealed. Obviously, ~~I need to practice more, much more~~&nbsp;Practicing!</p>
<p><strong>Objective</strong> </p>
<blockquote>
<p>At the end of the 1 hr, you should have created a chart to display <strong>retention rate</strong> per quarter, and you will also be asked to explain your steps / logic. May ignore quarters that aren&#8217;t complete (e.g. Q3&nbsp;2013)</p>
</blockquote>
<p><strong>Definition</strong></p>
<ul>
<li>Retention rate is calculated for experience entrepreneurs (<span class="caps">EE</span>)&nbsp;only.</li>
<li>Experienced entrepreneur (<span class="caps">EE</span>): Entrepreneur who has at least 3 months of sales data (i.e. He/She becomes <span class="caps">EE</span> at the end of the 3rd months with sales). Entrepreneurs with less than 3 months of experience are considered as new entrepreneurs (<span class="caps">NE</span>).</li>
<li>Retention rate for <span class="caps">EE</span>: Out of all the <span class="caps">EE</span> that started a period, how many % ended that period. Calculation of retention rate = (<span class="caps">EE</span> at start of period - <span class="caps">EE</span> dropped during period) / <span class="caps">EE</span> at start of&nbsp;period</li>
<li><span class="caps">EE</span> at start of period + <span class="caps">EE</span> joined during period - <span class="caps">EE</span> dropped during period = <span class="caps">EE</span> at end of&nbsp;period</li>
<li>How does an <span class="caps">EE</span> drop out? When there are 3 consecutive months of no sales (i.e. drops at the end of the 3rd month without&nbsp;sales)</li>
<li>After an <span class="caps">EE</span> dropped and joins again, he is an <span class="caps">EE</span>&nbsp;immediately.</li>
</ul>
<p><strong>Examples</strong></p>
<p><img alt="example" src="https://dl.dropboxusercontent.com/u/18094167/BlogImages/VBA%20Examples1.png"></p>
<p>sample retention rate for Q2,&nbsp;Q3</p>
<p>Q2: month4 -&nbsp;month6 </p>
<p><span class="caps">EE</span> at start of the period:&nbsp;7</p>
<p><span class="caps">EE</span> dropped out during the period:&nbsp;3</p>
<p>retention rate:  4/7x100%  =&nbsp;57%</p>
<p>Q3:moth7 -&nbsp;month9</p>
<p><span class="caps">EE</span> at start of the period:&nbsp;5</p>
<p><span class="caps">EE</span> dropped out during the period:&nbsp;3</p>
<p>retention rate:&nbsp;40%</p>
<p><strong>Full&nbsp;Dataset</strong></p>
<p>Download full dataset <a href="https://dl.dropboxusercontent.com/u/18094167/VBA%20case%20study%201.xlsx">here @ <span class="caps">VBA</span>-case study 1</a>.</p>
<p><strong>My&nbsp;Approach</strong></p>
<p><em>Analysis</em></p>
<ul>
<li>Q1 starts from January and ends in March,rigorously. The same logic applies to Q2,Q3,Q4. ( Each company has its own fisical year, define in this way to avoid complexity coming from random starting of a quarter. Otherwise, a more complex model to calcualte retention rate per&nbsp;month).</li>
<li>
<p>Algorithm:</p>
<ol>
<li>Convert sales data to rating of the entrepreneurs (<span class="caps">NE</span>,<span class="caps">EE</span> or dropout). All data needed to calculate the retention rate should be by far&nbsp;ready.</li>
<li>Count the <span class="caps">EE</span> at the start of each quater,&nbsp;N1_start;</li>
<li>Count the <span class="caps">EE</span> dropouts within each&nbsp;quarter,N1_dropuouts; </li>
<li>Count the newly joined <span class="caps">EE</span> during the&nbsp;period,N1_new;</li>
<li>Calculate the retention rate for each quater,(N1_start&nbsp;-N1_dropuouts)/N1_start.  </li>
</ol>
</li>
<li>
<p>divide and conquer the essential first&nbsp;step</p>
<ul>
<li><span class="caps">EE</span>: <ul>
<li>at least 3 months of sales data (no need to be consecutive; 0 could indicate no sale, in Excel it will be empty&nbsp;cell);</li>
<li>returning <span class="caps">EE</span> dropouts become <span class="caps">EE</span>&nbsp;immediately; </li>
</ul>
</li>
<li><span class="caps">NE</span>: less than 3 months&#8217;&nbsp;sales; </li>
<li>Dropuouts: 3 or more consecutive months of no&nbsp;sales;</li>
<li>Entrepreneurs are independent from each other, so the method of converting sales data to rating will be apply to each one&nbsp;repeatedly.(Iteration) </li>
</ul>
</li>
</ul>
<p><strong>Note</strong>
After checking abnormal results calculated from the codes, I found that some &#8220;empty-appearing&#8221; cells are actually not empty, which causes big problems. One way to solve the problem is to <em>clear contents</em> of those &#8220;empty&nbsp;cells&#8221;. </p>
<div class="highlight"><pre><span class="code-line"><span></span>sample code to clear contents of &#39;empty cell&#39;</span>
<span class="code-line"></span>
<span class="code-line">    For Each c In Selection</span>
<span class="code-line">        If Len(c) = 0 Then c.ClearContents</span>
<span class="code-line">    Next c</span>
</pre></div>


<p>Algorithm:</p>
<div class="highlight"><pre><span class="code-line"><span></span>1) Conversion</span>
<span class="code-line"></span>
<span class="code-line">  matrix consisting of four different status: </span>
<span class="code-line">    Empty</span>
<span class="code-line">    NE</span>
<span class="code-line">    EE</span>
<span class="code-line">    Dropout</span>
<span class="code-line"></span>
<span class="code-line"> a counts Number of EE; b counts number of empty cells</span>
<span class="code-line"></span>
<span class="code-line"> a = 0: empty</span>
<span class="code-line"> a = 1, 2: NE</span>
<span class="code-line">    b &lt; 3 NE</span>
<span class="code-line">    b = 3 (consecutive, no data+1,data reset to 0):dropuout;</span>
<span class="code-line">    b &gt;= 4 empty</span>
<span class="code-line"></span>
<span class="code-line"> a &gt;= 3: EE</span>
<span class="code-line">    b &lt; 3 EE</span>
<span class="code-line">    b = 3 (consecutive, no data+1,data reset to 0):dropuout;</span>
<span class="code-line">    b &gt;= 4 empty</span>
<span class="code-line"></span>
<span class="code-line"> 2)Calculation</span>
<span class="code-line"></span>
<span class="code-line"> for Quater k (row i, column j,j+1,j+2)</span>
<span class="code-line"></span>
<span class="code-line">    retented EE: (i,j)&amp;(i,j+1)&amp;(i,j+2) true </span>
<span class="code-line">    EE at the start: All EE at column j</span>
<span class="code-line">    retention rate:</span>
</pre></div>


<p><strong>Code</strong></p>
<div class="highlight"><pre><span class="code-line"><span></span>Option Explicit</span>
<span class="code-line">Sub RetentionRate()</span>
<span class="code-line"></span>
<span class="code-line">Dim xrow, xcol, x, y, i, j As Integer</span>
<span class="code-line">&#39;xrow: number of rows</span>
<span class="code-line">&#39;xcol: number of columns</span>
<span class="code-line">&#39;x-rowl;y -col</span>
<span class="code-line">&#39;i count NE/EE</span>
<span class="code-line">&#39;j count dropout</span>
<span class="code-line"></span>
<span class="code-line">Dim sht, shtB, shtC As Worksheet</span>
<span class="code-line">Dim rng As Range</span>
<span class="code-line"></span>
<span class="code-line">Set sht = ThisWorkbook.Sheets(2)</span>
<span class="code-line">Set shtB = ThisWorkbook.Sheets(3) &#39; storing output of converted data</span>
<span class="code-line">Set shtC = ThisWorkbook.Sheets(4) &#39; tracking the change of counters, for debugging</span>
<span class="code-line">Set rng = sht.UsedRange</span>
<span class="code-line"></span>
<span class="code-line">xrow = rng.Rows.Count</span>
<span class="code-line">&#39;count the rows in the usedrange, rng.row returns the first row number</span>
<span class="code-line"></span>
<span class="code-line">xcol = rng.Columns.Count</span>
<span class="code-line">&#39;count the columns in the used range</span>
<span class="code-line"></span>
<span class="code-line">&#39;copy table titles</span>
<span class="code-line"></span>
<span class="code-line">sht.Columns(&quot;A:B&quot;).Copy Destination:=shtB.Columns(&quot;A:B&quot;)</span>
<span class="code-line">sht.Rows(1).Copy Destination:=shtB.Rows(1)</span>
<span class="code-line"></span>
<span class="code-line">&#39; convert raw data&#39;</span>
<span class="code-line"></span>
<span class="code-line">&#39;clear fake empty cells</span>
<span class="code-line"></span>
<span class="code-line">For Each rng In sht.UsedRange</span>
<span class="code-line">    If Len(rng) = 0 Then rng.ClearContents</span>
<span class="code-line">Next rng</span>
<span class="code-line"></span>
<span class="code-line">For x = 2 To xrow   &#39;by default starting from 0, starting from the second row</span>
<span class="code-line"></span>
<span class="code-line">    i = 0</span>
<span class="code-line">    j = 0</span>
<span class="code-line"></span>
<span class="code-line">    For y = 3 To xcol &#39; col0-area officer; col1-entrepreneur</span>
<span class="code-line"></span>
<span class="code-line">        If IsEmpty(sht.Cells(x, y).Value) = False Then  &#39;test if the cells contain data</span>
<span class="code-line">            i = i + 1</span>
<span class="code-line">            j = 0</span>
<span class="code-line">            shtC.Cells(x, y) = i</span>
<span class="code-line"></span>
<span class="code-line">                Select Case i</span>
<span class="code-line">                    Case 1</span>
<span class="code-line">                    shtB.Cells(x, y).Value = &quot;NE&quot;</span>
<span class="code-line">                    Case 2</span>
<span class="code-line">                    shtB.Cells(x, y).Value = &quot;NE&quot;</span>
<span class="code-line">                    Case Is &gt;= 3</span>
<span class="code-line">                    shtB.Cells(x, y).Value = &quot;EE&quot;</span>
<span class="code-line">                End Select</span>
<span class="code-line">        Else</span>
<span class="code-line">            j = j + 1</span>
<span class="code-line">            shtC.Cells(x, y) = i</span>
<span class="code-line"></span>
<span class="code-line">            Select Case i</span>
<span class="code-line">                Case Is &gt;= 3</span>
<span class="code-line">                    If j &lt; 3 Then</span>
<span class="code-line">                        shtB.Cells(x, y).Value = &quot;EE&quot;</span>
<span class="code-line">                    ElseIf j = 3 Then</span>
<span class="code-line">                        shtB.Cells(x, y).Value = &quot;dropout&quot;</span>
<span class="code-line">                    Else</span>
<span class="code-line">                        shtB.Cells(x, y).Value = &quot; &quot;</span>
<span class="code-line">                    End If</span>
<span class="code-line">                 Case 2</span>
<span class="code-line">                     If j &lt; 3 Then</span>
<span class="code-line">                        shtB.Cells(x, y).Value = &quot;NE&quot;</span>
<span class="code-line">                    ElseIf j = 3 Then</span>
<span class="code-line">                        shtB.Cells(x, y).Value = &quot;dropout&quot;</span>
<span class="code-line">                    Else</span>
<span class="code-line">                        shtB.Cells(x, y).Value = &quot; &quot;</span>
<span class="code-line">                    End If</span>
<span class="code-line">                Case 1</span>
<span class="code-line">                    If j &lt; 3 Then</span>
<span class="code-line">                        shtB.Cells(x, y).Value = &quot;NE&quot;</span>
<span class="code-line">                    ElseIf j = 3 Then</span>
<span class="code-line">                        shtB.Cells(x, y).Value = &quot;dropout&quot;</span>
<span class="code-line">                    Else</span>
<span class="code-line">                        shtB.Cells(x, y).Value = &quot; &quot;</span>
<span class="code-line">                    End If</span>
<span class="code-line">                Case 0</span>
<span class="code-line">                    shtB.Cells(x, y).Value = &quot;&quot;</span>
<span class="code-line">            End Select</span>
<span class="code-line"></span>
<span class="code-line">        End If</span>
<span class="code-line"></span>
<span class="code-line">    Next y</span>
<span class="code-line"></span>
<span class="code-line">Next x</span>
<span class="code-line"></span>
<span class="code-line"></span>
<span class="code-line">&#39;Calcualte retention rate</span>
<span class="code-line"></span>
<span class="code-line"></span>
<span class="code-line">For y = 3 To xcol</span>
<span class="code-line">    i = 0</span>
<span class="code-line">    j = 0</span>
<span class="code-line">    If (y - 1) Mod 3 = 0 Then</span>
<span class="code-line"></span>
<span class="code-line">        For x = 2 To xrow</span>
<span class="code-line">             &#39;sum up all EE at the start of each quater</span>
<span class="code-line">            If shtB.Cells(x, y).Value = &quot;EE&quot; Then i = i + 1</span>
<span class="code-line">            &#39;sum up the dropouts of EE within each quater</span>
<span class="code-line">            If shtB.Cells(x, y).Value = &quot;EE&quot; And shtB.Cells(x, y + 1).Value = &quot;EE&quot; And shtB.Cells(x, y + 2).Value = &quot;EE&quot; Then j = j + 1</span>
<span class="code-line"></span>
<span class="code-line">        Next x</span>
<span class="code-line"></span>
<span class="code-line">        shtB.Cells(xrow + 1, y).Value = i</span>
<span class="code-line"></span>
<span class="code-line">        shtB.Cells(xrow + 2, y).Value = j</span>
<span class="code-line"></span>
<span class="code-line">            &#39;calculate retention rate</span>
<span class="code-line">        If i &lt;&gt; 0 And j &lt;&gt; 0 Then</span>
<span class="code-line">            shtB.Cells(xrow + 3, y).Value = j / i</span>
<span class="code-line">            shtB.Cells(xrow + 4, y).Value = sht.Cells(1, y).Value</span>
<span class="code-line">        Else</span>
<span class="code-line">            shtB.Cells(xrow + 3, y).Value = &quot;N.A.&quot;</span>
<span class="code-line">        End If</span>
<span class="code-line">    Else</span>
<span class="code-line">    End If</span>
<span class="code-line">Next y</span>
</pre></div>


<p>End&nbsp;Sub</p>
<p><strong>Here&#8217;s <a href="https://dl.dropboxusercontent.com/u/18094167/vba-case%20study%201-Code.bas">the&nbsp;code</a> </strong></p>
<p>There&#8217;s more could be done with this set of data. For example, evaluate the performance of the area officers based on the retention rate of the entrepreneurs.Or evaluate the performance of the&nbsp;entrepreneurs. </p>
        </div>

        <div class="meta">
            <div>
                    <a href="../../../../../tag/tech-it.html" class="tag">tech-iT</a>
            </div>
        </div>
    </article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
    <script type="text/javascript">
      var disqus_shortname = 'linnus';
      var disqus_identifier = '/posts/2015/Aug/30/vba case study 1/';
      var disqus_url = '../../../../../posts/2015/Aug/30/vba case study 1/';
      var disqus_title = '<span class="caps">VBA</span>-case study&nbsp;1';
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = "//" + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  </section>

</div>

<style type="text/css">
{
    max-width: 700px;
}

.text_cell .prompt {
    display: none;
}

div.cell {
    padding: 0;
}

div.text_cell_render {
    padding: 0;
}

div.prompt {
    font-size: 13px;
}

div.input_prompt {
    padding: .7em 0.2em;
}

div.output_prompt {
    padding: .4em .2em;
}

div.input_area {
    margin: .2em 0.4em;
    max-width: 580px;
}

table.dataframe {
    font-family: Arial, sans-serif;
    font-size: 13px;
    line-height: 20px;
}

table.dataframe th, td {
    padding: 4px;
    text-align: left;
}

pre code {
    background-color: inherit;
}</style>

        </div>
<!--
    <footer>
      <p>
        © 2012-2017 JIN Lin, license <a href=""> </a>
        unless otherwise noted.
        Generated by <a href= "http://docs.getpelican.com/">Pelican</a>.
      </p>
    </footer>
-->
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-64765479-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-64765479-1');
    ga('send', 'pageview');
</script>
    </body>
</html>